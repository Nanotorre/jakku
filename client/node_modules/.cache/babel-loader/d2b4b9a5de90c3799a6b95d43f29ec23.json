{"ast":null,"code":"import _toConsumableArray from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from\"react\";import\"./App.css\";import{Switch,Route,Redirect}from\"react-router-dom\";import Login from\"./components/auth/Login\";import Signup from\"./components/auth/Signup\";import GoogleAuth from\"./components/auth/GoogleAuth\";import AuthService from\"./components/auth/Authservice\";import RoutesService from\"./RoutesService\";import Home from\"./components/pages/Home\";import HomeLogged from\"./components/pages/HomeLogged\";import Button from\"@material-ui/core/Button\";import CssBaseline from\"@material-ui/core/CssBaseline\";import CreateBid from\"./components/organisms/CreateBid\";import CreateProduct from\"./components/organisms/CreateProduct\";import ShowMyBid from\"./components/pages/ShowMyBid\";import ShowBid from\"./components/pages/ShowBid\";import Navbar from\"./components/organisms/Navbar\";import ShowMyProduct from\"./components/pages/ShowMyProduct\";import ShowMyPurchases from\"./components/pages/ShowMyPurchases\";import ShowProduct from\"./components/pages/ShowProduct\";import'./styles/main.scss';import Auth from\"./components/auth/Auth\";import ModalLogin from\"./components/auth/ModalLogin\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this));_this.getUser=function(userObj){_this.setState(_objectSpread({},_this.state,{loggedInUser:userObj}));};_this.logout=function(){console.log(\"logout done\");_this.service.logout().then(function(){_this.setState(_objectSpread({},_this.state,{loggedInUser:null}));});};_this.fetchUser=function(){return _this.service.loggedin().then(function(response){_this.setState(_objectSpread({},_this.state,{loggedInUser:response}),console.log(\"fetch/////\",_this.state));}).catch(function(error){_this.setState(_objectSpread({},_this.state,{loggedInUser:false}));});};_this.getGeoLocation=function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(position){_this.setState(_objectSpread({},_this.state,{position:{lat:position.coords.latitude,lng:position.coords.longitude}}));});}};_this.state={loggedInUser:null,bid:null,product:null,products:null,position:{lat:40.3923071,lng:-3.6996187}};_this.service=new AuthService();_this.router=new RoutesService();_this.fetchUser();_this.getProducts();_this.getGeoLocation();return _this;}_createClass(App,[{key:\"changeStateBid\",value:function changeStateBid(newValue){this.fetchUser();console.log(newValue);console.log(\"bid actualizada\",this.state);}},{key:\"getProduct\",value:function getProduct(id){var _this2=this;return this.router.getProduct(id).then(function(response){_this2.setState(_objectSpread({},_this2.state,{product:response}));console.log(\"vuelta de productid\",_this2.state);}).catch(function(error){return console.log(error);});}},{key:\"buyProduct\",value:function buyProduct(id){var _this3=this;return this.router.buyProduct(id).then(function(response){_this3.setState(_objectSpread({},_this3.state,{product:response}));_this3.getProducts();});}},{key:\"getProducts\",value:function getProducts(){var _this4=this;return this.router.getProducts().then(function(response){response.sort(function(a,b){return Math.random()-0.5;});_this4.setState(_objectSpread({},_this4.state,{products:response}));});}},{key:\"shuffleProducts\",value:function shuffleProducts(){var shuffled=_toConsumableArray(this.props.products).sort(function(a,b){return Math.random()-0.5;});this.setState(_objectSpread({},this.state,{products:shuffled}));console.log(\"logged props\",this.props);}},{key:\"render\",value:function render(){var _this5=this;var onSuccess=function onSuccess(payment){return console.log('Successful payment!',payment);};var onError=function onError(error){return console.log('Erroneous payment OR failed to load script!',error);};var onCancel=function onCancel(data){return console.log('Cancelled payment!',data);};return this.state.loggedInUser?React.createElement(\"div\",{className:\"render-login\"},React.createElement(\"div\",{className:\"body-render-login\"},React.createElement(Navbar,{className:\"nav-logged\",user:this.state.loggedInUser,logMeOut:this.logout}),React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\",render:function render(){return React.createElement(\"div\",{className:\"page\"},React.createElement(HomeLogged,{user:_this5.state.loggedInUser,productsFromApp:function productsFromApp(){_this5.getProducts();},centerMap:_this5.state.position,products:_this5.state.products// bids={this.state.bids}\n}));}}),React.createElement(Route,{exact:true,path:\"/create-bid\",render:function render(){// if (this.state.loggedInUser.bid) {\n//   return (\n//     <div className=\"page\">\n//       <h1>Ya tienes una subasta activa</h1>\n//       <p>Link al panel de control de tu mudanza</p>\n//     </div>\n//   );\n// } else {\nreturn React.createElement(\"div\",{className:\"page page-create-bid\"},React.createElement(CreateBid,{fromApp:function fromApp(newValue){return _this5.changeStateBid(newValue);},user:_this5.state.loggedInUser}));// }\n}}),React.createElement(Route,{exact:true,path:\"/create-product\",render:function render(){console.log(\"llama create product\",_this5.state.loggedInUser);return React.createElement(\"div\",{className:\"page page-create-product\"},React.createElement(CreateProduct,{user:_this5.state.loggedInUser,fromApp:function fromApp(){return _this5.fetchUser();},fromAppRefreshProducts:function fromAppRefreshProducts(){return _this5.getProducts();},bid:_this5.state.loggedInUser.bid?_this5.state.loggedInUser.bid._id:null}));}}),React.createElement(Route,{exact:true,path:\"/your-bid\",render:function render(){return React.createElement(\"div\",{className:\"page page-mybid\"},React.createElement(ShowMyBid,{fromApp:function fromApp(){return _this5.fetchUser();},user:_this5.state.loggedInUser,products:_this5.state.loggedInUser.products,centerMap:_this5.state.position}));}}),React.createElement(Route,{path:\"/bid/:id\",render:function render(props){return React.createElement(\"div\",{className:\"page page-bid-id\"},React.createElement(ShowBid// BidFromApp={() => this.GetBid()}\n,{id:props.match.params.id,user:_this5.state.loggedInUser,centerMap:_this5.state.position}));}}),React.createElement(Route,{path:\"/product/:id\",render:function render(props){return React.createElement(\"div\",{className:\"page page-product-id\"},React.createElement(ShowProduct,{productFromApp:function productFromApp(){return _this5.getProduct(props.match.params.id);},product:_this5.state.product,fromApp:function fromApp(){return _this5.fetchUser();},userId:_this5.state.loggedInUser._id,buyFromApp:function buyFromApp(id){return _this5.buyProduct(id);},centerMap:_this5.state.position}));}}),React.createElement(Route,{path:\"/my-product/:id\",render:function render(props){var chosenProduct=props.match.params.id;return React.createElement(\"div\",{className:\"page page-myproduct-id\"},React.createElement(ShowMyProduct,{productId:chosenProduct,fromApp:function fromApp(){return _this5.fetchUser();},user:_this5.state.loggedInUser,product:null}));}}),React.createElement(Route,{exact:true,path:\"/my-purchases\",render:function render(props){var productsOwned=_this5.state.products.filter(function(product){return product.buyer?product.buyer==_this5.state.loggedInUser._id:false;});return React.createElement(\"div\",{className:\"page page-purchases\"},React.createElement(ShowMyPurchases,{fromApp:function fromApp(){return _this5.fetchUser();},user:_this5.state.loggedInUser,products:productsOwned}));}})))):React.createElement(\"div\",{className:\"render-nologin\"},React.createElement(\"div\",{className:\"body-render-nologin\"},React.createElement(Navbar,{className:\"nav-logged\",logMeOut:this.logout}),React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\",render:function render(){return React.createElement(\"div\",{className:\"page page-home-not-logged\"},React.createElement(Home,{productsFromApp:function productsFromApp(){_this5.getProducts();},centerMap:_this5.state.position,products:_this5.state.products}));}}),React.createElement(Route,{exact:true,path:\"/signup\",render:function render(){return React.createElement(\"div\",{className:\"page page-singup\"},React.createElement(Auth,{getUser:_this5.getUser}));}}),React.createElement(Route,{exact:true,path:\"/create-bid\",render:function render(){return React.createElement(\"div\",{className:\"page page-create-notlog\"},React.createElement(Auth,null));}}),React.createElement(Route,{exact:true,path:\"/create-product\",render:function render(){return React.createElement(\"div\",{className:\"page page-create-notlog\"},React.createElement(\"h1\",null,\"Tienes que estar registrado y tener una mudanza activa para poder crear cajas con productos\",\" \"),React.createElement(Login,{getUser:_this5.getUser}),React.createElement(Signup,{getUser:_this5.getUser}),React.createElement(GoogleAuth,{getUser:_this5.getUser}),React.createElement(\"a\",{href:\"http://localhost:3010/auth/google\"},\"Sign In with Google\"),React.createElement(Button,{variant:\"contained\",color:\"primary\"}));}}),React.createElement(Route,{path:\"/product/:id\",render:function render(props){return React.createElement(\"div\",{className:\"page page-product-id\"});}}))));}}]);return App;}(Component);export{App as default};","map":{"version":3,"sources":["/Users/fer/ironhack/week_8/jakku/client/src/App.js"],"names":["React","Component","Switch","Route","Redirect","Login","Signup","GoogleAuth","AuthService","RoutesService","Home","HomeLogged","Button","CssBaseline","CreateBid","CreateProduct","ShowMyBid","ShowBid","Navbar","ShowMyProduct","ShowMyPurchases","ShowProduct","Auth","ModalLogin","App","props","getUser","userObj","setState","state","loggedInUser","logout","console","log","service","then","fetchUser","loggedin","response","catch","error","getGeoLocation","navigator","geolocation","getCurrentPosition","position","lat","coords","latitude","lng","longitude","bid","product","products","router","getProducts","newValue","id","getProduct","buyProduct","sort","a","b","Math","random","shuffled","onSuccess","payment","onError","onCancel","data","changeStateBid","_id","match","params","chosenProduct","productsOwned","filter","buyer"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport { Switch, Route, Redirect } from \"react-router-dom\";\nimport Login from \"./components/auth/Login\";\nimport Signup from \"./components/auth/Signup\";\n\nimport GoogleAuth from \"./components/auth/GoogleAuth\";\nimport AuthService from \"./components/auth/Authservice\";\nimport RoutesService from \"./RoutesService\";\n\nimport Home from \"./components/pages/Home\";\nimport HomeLogged from \"./components/pages/HomeLogged\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport CreateBid from \"./components/organisms/CreateBid\";\nimport CreateProduct from \"./components/organisms/CreateProduct\";\nimport ShowMyBid from \"./components/pages/ShowMyBid\";\nimport ShowBid from \"./components/pages/ShowBid\";\nimport Navbar from \"./components/organisms/Navbar\";\nimport ShowMyProduct from \"./components/pages/ShowMyProduct\";\nimport ShowMyPurchases from \"./components/pages/ShowMyPurchases\";\nimport ShowProduct from \"./components/pages/ShowProduct\";\nimport './styles/main.scss'\nimport Auth from \"./components/auth/Auth\";\nimport ModalLogin from \"./components/auth/ModalLogin\";\n\nexport default class App extends Component {\n  constructor(props) {\n    super();\n    this.state = {\n      loggedInUser: null,\n      bid: null,\n      product: null,\n      products: null,\n      position: { lat: 40.3923071, lng: -3.6996187 }\n    };\n    this.service = new AuthService();\n    this.router = new RoutesService();\n    this.fetchUser();\n    this.getProducts();\n    this.getGeoLocation();\n  }\n\n  getUser = userObj => {\n    this.setState({\n      ...this.state,\n      loggedInUser: userObj\n    });\n  };\n\n  logout = () => {\n    console.log(\"logout done\");\n    this.service.logout().then(() => {\n      this.setState({\n        ...this.state,\n        loggedInUser: null\n      });\n    });\n  };\n\n  fetchUser = () => {\n    return this.service\n      .loggedin()\n      .then(response => {\n        this.setState({\n          ...this.state,\n          loggedInUser: response\n        }, console.log(\"fetch/////\", this.state));\n        \n      })\n      .catch(error => {\n        this.setState({\n          ...this.state,\n          loggedInUser: false\n        });\n      });\n  };\n  changeStateBid(newValue) {\n    this.fetchUser();\n    console.log(newValue);\n    console.log(\"bid actualizada\", this.state);\n  }\n\n  getProduct(id) {\n    return this.router\n      .getProduct(id)\n      .then(response => {\n        this.setState({\n          ...this.state,\n          product: response\n        });\n        console.log(\"vuelta de productid\", this.state);\n      })\n      .catch(error => console.log(error));\n  }\n  buyProduct(id) {\n    return this.router.buyProduct(id).then(response => {\n      this.setState({\n        ...this.state,\n        product: response\n      });\n      this.getProducts();\n\n    });\n  }\n  getProducts() {\n    return this.router.getProducts().then(response => {\n      response.sort((a, b) => Math.random() - 0.5);\n      this.setState({\n        ...this.state,\n        products: response\n      });\n\n    });\n  }\n  shuffleProducts() {\n    const shuffled = [...this.props.products].sort(\n      (a, b) => Math.random() - 0.5\n    );\n    this.setState({\n      ...this.state,\n      products: shuffled\n    });\n    console.log(\"logged props\", this.props);\n  }\n  getGeoLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        this.setState({\n          ...this.state,\n          position: {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          }\n        });\n      });\n    }\n  };\n  \n\n  render() {\n    const onSuccess = (payment) =>\n      console.log('Successful payment!', payment);\n    const onError = (error) =>\n      console.log('Erroneous payment OR failed to load script!', error);\n    const onCancel = (data) =>\n      console.log('Cancelled payment!', data);\n\n\n    return this.state.loggedInUser ? (\n    \n      <div className=\"render-login\">\n        <div className=\"body-render-login\">\n        <Navbar\n          className=\"nav-logged\"\n          user={this.state.loggedInUser}\n          logMeOut={this.logout}\n        />\n        \n        <Switch>\n          <Route\n            exact\n            path=\"/\"\n            render={() => {\n              return (\n                <div className=\"page\">\n                  <HomeLogged\n                    user={this.state.loggedInUser}\n                    productsFromApp={() => {\n                      this.getProducts();\n                    }}\n                    centerMap={this.state.position}\n                    products={this.state.products}\n                    // bids={this.state.bids}\n                  ></HomeLogged>\n                </div>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-bid\"\n            render={() => {\n              // if (this.state.loggedInUser.bid) {\n              //   return (\n              //     <div className=\"page\">\n              //       <h1>Ya tienes una subasta activa</h1>\n              //       <p>Link al panel de control de tu mudanza</p>\n              //     </div>\n              //   );\n              // } else {\n                return (\n                  <div className=\"page page-create-bid\">\n                    <CreateBid\n                      fromApp={newValue => this.changeStateBid(newValue)}\n                      user={this.state.loggedInUser}\n                    ></CreateBid>\n                  </div>\n                );\n              // }\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-product\"\n            render={() => {\n              console.log(\"llama create product\", this.state.loggedInUser);\n\n              return (\n                <div className=\"page page-create-product\">\n                  <CreateProduct\n                    user={this.state.loggedInUser}\n                    fromApp={() => this.fetchUser()}\n                    fromAppRefreshProducts={() => this.getProducts()}\n                    bid={\n                      this.state.loggedInUser.bid\n                        ? this.state.loggedInUser.bid._id\n                        : null\n                    }\n                  ></CreateProduct>\n                </div>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/your-bid\"\n            render={() => {\n              \n              return (\n                <div className=\"page page-mybid\">\n                  <ShowMyBid\n                    fromApp={() => this.fetchUser()}\n                    user={this.state.loggedInUser}\n                    products={this.state.loggedInUser.products}\n                    centerMap={this.state.position}\n                  ></ShowMyBid>\n                </div>\n              );\n            }}\n          />\n          <Route\n            path=\"/bid/:id\"\n            render={props => {\n              return (\n                <div className=\"page page-bid-id\">\n      \n                  <ShowBid\n                    // BidFromApp={() => this.GetBid()}\n                    id={props.match.params.id}\n                    user={this.state.loggedInUser}\n                    centerMap={this.state.position}\n                  ></ShowBid>\n                </div>\n              );\n            }}\n          />\n\n          <Route\n            path=\"/product/:id\"\n            render={props => {\n              return (\n                <div className=\"page page-product-id\">\n                  <ShowProduct\n                    productFromApp={() =>\n                      this.getProduct(props.match.params.id)\n                    }\n                    product={this.state.product}\n                    fromApp={() => this.fetchUser()}\n                    userId={this.state.loggedInUser._id}\n                    buyFromApp={id => this.buyProduct(id)}\n                    centerMap={this.state.position}\n                  ></ShowProduct>\n                </div>\n              );  \n            }}\n          />\n\n          <Route\n            path=\"/my-product/:id\"\n            render={props => {\n              let chosenProduct = props.match.params.id;\n              return (\n                <div className=\"page page-myproduct-id\">\n                  <ShowMyProduct\n                    productId={chosenProduct}\n                    fromApp={() => this.fetchUser()}\n                    user={this.state.loggedInUser}\n                    product={null}\n                  ></ShowMyProduct>\n                </div>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/my-purchases\"\n            render={props => {\n             \n              let productsOwned = this.state.products.filter(product =>{\n                return  product.buyer?  product.buyer == this.state.loggedInUser._id \n                : false\n              });\n              return (\n                <div className=\"page page-purchases\">\n                  <ShowMyPurchases\n                \n                    fromApp={() => this.fetchUser()}\n                    user={this.state.loggedInUser}\n                    products={productsOwned}\n                  ></ShowMyPurchases>\n                </div>\n              );\n            }}\n          />\n        </Switch>\n        </div>\n        {/* <FooterBar></FooterBar> */}\n      </div>\n    ) :\n    \n    \n    \n    \n    \n    \n    \n    (\n        <div className=\"render-nologin\">\n        <div className=\"body-render-nologin\">\n        <Navbar className=\"nav-logged\" logMeOut={this.logout} />\n        <Switch>\n          <Route\n            exact\n            path=\"/\"\n            render={() => {\n              return (\n                  <div className=\"page page-home-not-logged\">\n                  <Home\n                    productsFromApp={() => {\n                      this.getProducts();\n                    }}\n                    centerMap={this.state.position}\n                    products={this.state.products}\n                  ></Home>\n                </div>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/signup\"\n            render={() => {\n              return (\n                <div className=\"page page-singup\">\n                <Auth getUser={this.getUser}></Auth>\n               \n                </div>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-bid\"\n            render={() => {\n              return (\n                <div className=\"page page-create-notlog\">\n               <Auth></Auth>\n                </div>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-product\"\n            render={() => {\n              return (\n                <div className=\"page page-create-notlog\">\n                  <h1>\n                    Tienes que estar registrado y tener una mudanza activa para\n                    poder crear cajas con productos{\" \"}\n                  </h1>\n                  <Login getUser={this.getUser}></Login>\n                  <Signup getUser={this.getUser}></Signup>\n                  <GoogleAuth getUser={this.getUser}></GoogleAuth>\n                  <a href=\"http://localhost:3010/auth/google\">\n                    Sign In with Google\n                  </a>\n                  <Button variant=\"contained\" color=\"primary\"></Button>\n                </div>\n              );\n            }}\n          />\n             <Route\n            path=\"/product/:id\"\n            render={props => {\n              \n              return (\n\n                <div className=\"page page-product-id\">\n                  {/* <ModalLogin></ModalLogin> */}\n                  \n                \n                  {/* <ShowProduct\n                    productFromApp={() =>\n                      this.getProduct(props.match.params.id)\n                    }\n                    product={this.state.product}\n                    fromApp={() => this.fetchUser()}\n                    userId={this.state.loggedInUser._id}\n                    buyFromApp={id => this.buyProduct(id)}\n                    centerMap={this.state.position}\n                  ></ShowProduct> */}\n                </div>\n              );  \n            }}\n          />\n        </Switch>\n        </div>\n        {/* <FooterBar></FooterBar> */}\n        </div>\n     \n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}