{"ast":null,"code":"import _toConsumableArray from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/fer/ironhack/week_8/jakku/client/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from\"react\";import\"./App.css\";import{Switch,Route,Redirect}from\"react-router-dom\";import Login from\"./components/auth/Login\";import Signup from\"./components/auth/Signup\";import GoogleAuth from\"./components/auth/GoogleAuth\";import AuthService from\"./components/auth/Authservice\";import RoutesService from\"./RoutesService\";import Home from\"./components/pages/Home\";import HomeLogged from\"./components/pages/HomeLogged\";import Button from\"@material-ui/core/Button\";import CssBaseline from\"@material-ui/core/CssBaseline\";import CreateBid from\"./components/organisms/CreateBid\";import CreateProduct from\"./components/organisms/CreateProduct\";import ShowMyBid from\"./components/pages/ShowMyBid\";import Navbar from\"./components/organisms/Navbar\";import ShowMyProduct from\"./components/pages/ShowMyProduct\";import ShowProduct from\"./components/pages/ShowProduct\";import'./styles/main.scss';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this));_this.getUser=function(userObj){_this.setState(_objectSpread({},_this.state,{loggedInUser:userObj}));};_this.logout=function(){console.log(\"logout done\");_this.service.logout().then(function(){_this.setState(_objectSpread({},_this.state,{loggedInUser:null}));});};_this.fetchUser=function(){return _this.service.loggedin().then(function(response){_this.setState(_objectSpread({},_this.state,{loggedInUser:response,products:[]}));console.log(\"fetch/////\",_this.state);}).catch(function(error){_this.setState(_objectSpread({},_this.state,{loggedInUser:false}));});};_this.getGeoLocation=function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(position){_this.setState(_objectSpread({},_this.state,{position:{lat:position.coords.latitude,lng:position.coords.longitude}}));console.log(_this.state.position);});}};_this.state={loggedInUser:null,bid:null,product:null,products:null,position:{lat:40.3923071,lng:-3.6996187}};_this.service=new AuthService();_this.router=new RoutesService();_this.fetchUser();_this.getProducts();_this.getGeoLocation();return _this;}_createClass(App,[{key:\"changeStateBid\",value:function changeStateBid(newValue){// const { from, to, deadLine } = newValue;\n// this.setState({\n//   ...this.state,\n//   bid: {\n//     from: from,\n//     to: to,\n//     deadLine: deadLine\n//   },\n//   nobid: \"xxxxxxxx\"\n// });\nthis.fetchUser();console.log(newValue);console.log(\"bid actualizada\",this.state);}},{key:\"getProduct\",value:function getProduct(id){var _this2=this;return this.router.getProduct(id).then(function(response){_this2.setState(_objectSpread({},_this2.state,{product:response}));console.log(\"vuelta de productid\",_this2.state);}).catch(function(error){return console.log(error);});}},{key:\"buyProduct\",value:function buyProduct(id){var _this3=this;return this.router.buyProduct(id).then(function(response){_this3.setState(_objectSpread({},_this3.state,{product:response}));console.log(\"vuelta de compra producto\",_this3.state);});}},{key:\"getProducts\",value:function getProducts(){var _this4=this;return this.router.getProducts().then(function(response){response.sort(function(a,b){return Math.random()-0.5;});_this4.setState(_objectSpread({},_this4.state,{products:response}));console.log(\"carga productos en state app\",_this4.state);});}},{key:\"shuffleProducts\",value:function shuffleProducts(){var shuffled=_toConsumableArray(this.props.products).sort(function(a,b){return Math.random()-0.5;});this.setState(_objectSpread({},this.state,{products:shuffled}));console.log(\"logged props\",this.props);}},{key:\"render\",value:function render(){var _this5=this;return this.state.loggedInUser?React.createElement(React.Fragment,null,React.createElement(Navbar,{className:\"nav-logged\",user:this.state.loggedInUser,logMeOut:this.logout}),React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\",render:function render(){console.log(\"antes de montar\",_this5.state);return React.createElement(React.Fragment,null,React.createElement(HomeLogged,{user:_this5.state.loggedInUser,productsFromApp:function productsFromApp(){_this5.getProducts();},centerMap:_this5.state.position,products:_this5.state.products// bids={this.state.bids}\n}));}}),React.createElement(Route,{exact:true,path:\"/create-bid\",render:function render(){if(_this5.state.loggedInUser.bid){return React.createElement(React.Fragment,null,React.createElement(\"h1\",null,\"Ya tienes una subasta activa\"),React.createElement(\"p\",null,\"Link al panel de control de tu mudanza\"));}else{return React.createElement(React.Fragment,null,\"estas log\",React.createElement(CreateBid,{fromApp:function fromApp(newValue){return _this5.changeStateBid(newValue);}}));}}}),React.createElement(Route,{exact:true,path:\"/create-product\",render:function render(){console.log(\"llama create product\",_this5.state.loggedInUser);return React.createElement(React.Fragment,null,React.createElement(CreateProduct,{fromApp:function fromApp(){return _this5.fetchUser();},fromAppRefreshProducts:function fromAppRefreshProducts(){return _this5.getProducts();},bid:_this5.state.loggedInUser.bid?_this5.state.loggedInUser.bid._id:null}));}}),React.createElement(Route,{exact:true,path:\"/your-bid\",render:function render(){return React.createElement(React.Fragment,null,React.createElement(ShowMyBid,{fromApp:function fromApp(){return _this5.fetchUser();},user:_this5.state.loggedInUser}));}}),React.createElement(Route,{path:\"/product/:id\",render:function render(props){return React.createElement(React.Fragment,null,React.createElement(ShowProduct,{productFromApp:function productFromApp(){return _this5.getProduct(props.match.params.id);},product:_this5.state.product,fromApp:function fromApp(){return _this5.fetchUser();},userId:_this5.state.loggedInUser._id,buyFromApp:function buyFromApp(id){return _this5.buyProduct(id);},centerMap:_this5.state.position}));}}),React.createElement(Route,{path:\"/my-product/:id\",render:function render(props){var chosenProduct=props.match.params.id;return React.createElement(React.Fragment,null,React.createElement(ShowMyProduct,{productId:chosenProduct,fromApp:function fromApp(){return _this5.fetchUser();},user:_this5.state.loggedInUser,product:null}));}}))):React.createElement(React.Fragment,null,React.createElement(Navbar,{className:\"nav-logged\",logMeOut:this.logout}),React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\",render:function render(){return React.createElement(Home,{productsFromApp:function productsFromApp(){_this5.getProducts();},centerMap:_this5.state.position,products:_this5.state.products});}}),React.createElement(Route,{exact:true,path:\"/signup\",render:function render(){return React.createElement(React.Fragment,null,React.createElement(Login,{getUser:_this5.getUser}),React.createElement(Signup,{getUser:_this5.getUser}),React.createElement(GoogleAuth,{getUser:_this5.getUser}),React.createElement(\"a\",{href:\"http://localhost:3010/auth/google\"},\"Sign In with Google\"));}}),React.createElement(Route,{exact:true,path:\"/create-bid\",render:function render(){return React.createElement(React.Fragment,null,React.createElement(\"h1\",null,\"Tienes que estar registrado para poder crear tu mudanza\"),React.createElement(Login,{getUser:_this5.getUser}),React.createElement(Signup,{getUser:_this5.getUser}),React.createElement(\"a\",{href:\"http://localhost:3010/auth/google\"},\"Sign In with Google\"));}}),React.createElement(Route,{exact:true,path:\"/create-product\",render:function render(){return React.createElement(React.Fragment,null,React.createElement(\"h1\",null,\"Tienes que estar registrado y tener una mudanza activa para poder crear cajas con productos\",\" \"),React.createElement(Login,{getUser:_this5.getUser}),React.createElement(Signup,{getUser:_this5.getUser}),React.createElement(GoogleAuth,{getUser:_this5.getUser}),React.createElement(\"a\",{href:\"http://localhost:3010/auth/google\"},\"Sign In with Google\"),React.createElement(Button,{variant:\"contained\",color:\"primary\"}));}})));}}]);return App;}(Component);export{App as default};","map":{"version":3,"sources":["/Users/fer/ironhack/week_8/jakku/client/src/App.js"],"names":["React","Component","Switch","Route","Redirect","Login","Signup","GoogleAuth","AuthService","RoutesService","Home","HomeLogged","Button","CssBaseline","CreateBid","CreateProduct","ShowMyBid","Navbar","ShowMyProduct","ShowProduct","App","props","getUser","userObj","setState","state","loggedInUser","logout","console","log","service","then","fetchUser","loggedin","response","products","catch","error","getGeoLocation","navigator","geolocation","getCurrentPosition","position","lat","coords","latitude","lng","longitude","bid","product","router","getProducts","newValue","id","getProduct","buyProduct","sort","a","b","Math","random","shuffled","changeStateBid","_id","match","params","chosenProduct"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport { Switch, Route, Redirect } from \"react-router-dom\";\nimport Login from \"./components/auth/Login\";\nimport Signup from \"./components/auth/Signup\";\n\n\nimport GoogleAuth from \"./components/auth/GoogleAuth\";\nimport AuthService from \"./components/auth/Authservice\";\nimport RoutesService from \"./RoutesService\";\n\nimport Home from \"./components/pages/Home\";\nimport HomeLogged from \"./components/pages/HomeLogged\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport CreateBid from \"./components/organisms/CreateBid\";\nimport CreateProduct from \"./components/organisms/CreateProduct\";\nimport ShowMyBid from \"./components/pages/ShowMyBid\";\nimport Navbar from \"./components/organisms/Navbar\";\nimport ShowMyProduct from \"./components/pages/ShowMyProduct\";\nimport ShowProduct from \"./components/pages/ShowProduct\";\nimport './styles/main.scss'\n\nexport default class App extends Component {\n  constructor(props) {\n    super();\n    this.state = {\n      loggedInUser: null,\n      bid: null,\n      product: null,\n      products: null,\n      position: { lat: 40.3923071, lng: -3.6996187 }\n    };\n    this.service = new AuthService();\n    this.router = new RoutesService();\n    this.fetchUser();\n    this.getProducts();\n    this.getGeoLocation();\n  }\n\n  getUser = userObj => {\n    this.setState({\n      ...this.state,\n      loggedInUser: userObj\n    });\n  };\n\n  logout = () => {\n    console.log(\"logout done\");\n    this.service.logout().then(() => {\n      this.setState({\n        ...this.state,\n        loggedInUser: null\n      });\n    });\n  };\n\n  fetchUser = () => {\n    return this.service\n      .loggedin()\n      .then(response => {\n        this.setState({\n          ...this.state,\n          loggedInUser: response,\n          products: []\n        });\n        console.log(\"fetch/////\", this.state);\n      })\n      .catch(error => {\n        this.setState({\n          ...this.state,\n          loggedInUser: false\n        });\n      });\n  };\n  changeStateBid(newValue) {\n    // const { from, to, deadLine } = newValue;\n    // this.setState({\n    //   ...this.state,\n    //   bid: {\n    //     from: from,\n    //     to: to,\n    //     deadLine: deadLine\n    //   },\n    //   nobid: \"xxxxxxxx\"\n    // });\n    this.fetchUser();\n    console.log(newValue);\n    console.log(\"bid actualizada\", this.state);\n  }\n\n  getProduct(id) {\n    return this.router\n      .getProduct(id)\n      .then(response => {\n        this.setState({\n          ...this.state,\n          product: response\n        });\n        console.log(\"vuelta de productid\", this.state);\n      })\n      .catch(error => console.log(error));\n  }\n  buyProduct(id) {\n    return this.router.buyProduct(id).then(response => {\n      this.setState({\n        ...this.state,\n        product: response\n      });\n      console.log(\"vuelta de compra producto\", this.state);\n    });\n  }\n  getProducts() {\n    return this.router.getProducts().then(response => {\n      response.sort((a, b) => Math.random() - 0.5);\n      this.setState({\n        ...this.state,\n        products: response\n      });\n      console.log(\"carga productos en state app\", this.state);\n    });\n  }\n  shuffleProducts() {\n    const shuffled = [...this.props.products].sort(\n      (a, b) => Math.random() - 0.5\n    );\n    this.setState({\n      ...this.state,\n      products: shuffled\n    });\n    console.log(\"logged props\", this.props);\n  }\n  getGeoLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        this.setState({\n          ...this.state,\n          position: {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          }\n        });\n        console.log(this.state.position);\n      });\n    }\n  };\n\n  render() {\n    return this.state.loggedInUser ? (\n      <React.Fragment>\n        <Navbar\n          className=\"nav-logged\"\n          user={this.state.loggedInUser}\n          logMeOut={this.logout}\n        />\n        \n        <Switch>\n          <Route\n            exact\n            path=\"/\"\n            render={() => {\n              console.log(\"antes de montar\", this.state);\n              return (\n                <React.Fragment>\n                  <HomeLogged\n                    user={this.state.loggedInUser}\n                    productsFromApp={() => {\n                      this.getProducts();\n                    }}\n                    centerMap={this.state.position}\n                    products={this.state.products}\n                    // bids={this.state.bids}\n                  ></HomeLogged>\n                </React.Fragment>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-bid\"\n            render={() => {\n              if (this.state.loggedInUser.bid) {\n                return (\n                  <React.Fragment>\n                    <h1>Ya tienes una subasta activa</h1>\n                    <p>Link al panel de control de tu mudanza</p>\n                  </React.Fragment>\n                );\n              } else {\n                return (\n                  <React.Fragment>\n                    estas log\n                    <CreateBid\n                      fromApp={newValue => this.changeStateBid(newValue)}\n                    ></CreateBid>\n                  </React.Fragment>\n                );\n              }\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-product\"\n            render={() => {\n              console.log(\"llama create product\", this.state.loggedInUser);\n\n              return (\n                <React.Fragment>\n                  <CreateProduct\n                    fromApp={() => this.fetchUser()}\n                    fromAppRefreshProducts={() => this.getProducts()}\n                    bid={\n                      this.state.loggedInUser.bid\n                        ? this.state.loggedInUser.bid._id\n                        : null\n                    }\n                  ></CreateProduct>\n                </React.Fragment>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/your-bid\"\n            render={() => {\n              return (\n                <React.Fragment>\n                  <ShowMyBid\n                    fromApp={() => this.fetchUser()}\n                    user={this.state.loggedInUser}\n                  ></ShowMyBid>\n                </React.Fragment>\n              );\n            }}\n          />\n          {/* <Route\n            exact\n            path=\"/bid/:id\"\n            render={() => {\n              return (\n                <React.Fragment>\n      \n                  <ShowBid\n                    BidFromApp={() => this.GetBid()}\n                    // user={this.state.loggedInUser}\n                  ></ShowBid>\n                </React.Fragment>\n              );\n            }}\n          /> */}\n\n          <Route\n            path=\"/product/:id\"\n            render={props => {\n              return (\n                <React.Fragment>\n                  <ShowProduct\n                    productFromApp={() =>\n                      this.getProduct(props.match.params.id)\n                    }\n                    product={this.state.product}\n                    fromApp={() => this.fetchUser()}\n                    userId={this.state.loggedInUser._id}\n                    buyFromApp={id => this.buyProduct(id)}\n                    centerMap={this.state.position}\n                  ></ShowProduct>\n                </React.Fragment>\n              );\n            }}\n          />\n\n          <Route\n            path=\"/my-product/:id\"\n            render={props => {\n              let chosenProduct = props.match.params.id;\n              return (\n                <React.Fragment>\n                  <ShowMyProduct\n                    productId={chosenProduct}\n                    fromApp={() => this.fetchUser()}\n                    user={this.state.loggedInUser}\n                    product={null}\n                  ></ShowMyProduct>\n                </React.Fragment>\n              );\n            }}\n          />\n        </Switch>\n      </React.Fragment>\n    ) :\n    \n    \n    \n    \n    \n    \n    \n    (\n      <React.Fragment>\n        <Navbar className=\"nav-logged\" logMeOut={this.logout} />\n        <Switch>\n          <Route\n            exact\n            path=\"/\"\n            render={() => {\n              return (\n         \n                  <Home\n                    productsFromApp={() => {\n                      this.getProducts();\n                    }}\n                    centerMap={this.state.position}\n                    products={this.state.products}\n                  ></Home>\n     \n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/signup\"\n            render={() => {\n              return (\n                <React.Fragment>\n                  <Login getUser={this.getUser}></Login>\n                  <Signup getUser={this.getUser}></Signup>\n                  <GoogleAuth getUser={this.getUser}></GoogleAuth>\n                  <a href=\"http://localhost:3010/auth/google\">\n                    Sign In with Google\n                  </a>\n                </React.Fragment>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-bid\"\n            render={() => {\n              return (\n                <React.Fragment>\n                  <h1>\n                    Tienes que estar registrado para poder crear tu mudanza\n                  </h1>\n                  <Login getUser={this.getUser}></Login>\n                  <Signup getUser={this.getUser}></Signup>\n                  {/* <GoogleAuth getUser={this.getUser}></GoogleAuth> */}\n                  <a href=\"http://localhost:3010/auth/google\">\n                    Sign In with Google\n                  </a>\n                </React.Fragment>\n              );\n            }}\n          />\n          <Route\n            exact\n            path=\"/create-product\"\n            render={() => {\n              return (\n                <React.Fragment>\n                  <h1>\n                    Tienes que estar registrado y tener una mudanza activa para\n                    poder crear cajas con productos{\" \"}\n                  </h1>\n                  <Login getUser={this.getUser}></Login>\n                  <Signup getUser={this.getUser}></Signup>\n                  <GoogleAuth getUser={this.getUser}></GoogleAuth>\n                  <a href=\"http://localhost:3010/auth/google\">\n                    Sign In with Google\n                  </a>\n                  <Button variant=\"contained\" color=\"primary\"></Button>\n                </React.Fragment>\n              );\n            }}\n          />\n        </Switch>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}